---
type: bbs
date: 2024-11-24
---
更新了一下Nboat4的所有依赖，同时修好了Nboat4的一个bug——当某标题以数字开头的时候，它的ID无法被解析器识别，从而造成Bootstrap5的scrollspy无法正确检测用户滚动的位置，导致功能缺失。

这个问题产生的原因是Bootstrap在根据ID重建CSS选择器时，被浏览器针对CSS选择器语法限制了——当id选择器以#加上标识符（id值）组成时，标识符的第一个字符不能是数字。比如如果我有一个小标题`##### 2. 对功能性协议的拦截`，无prefix时marked的marked-gfm-heading-id插件会将其ID设置为`2-对功能性协议的拦截`，而实际上这个id虽然是合法的id，但在bootstrap5重建dof的时候，会尝试构造一个选择器`#2-对功能性协议的拦截`，而这个选择器并不是合法的选择器，因为选择器不能在井号后跟一个数字，正确的做法应该是`#\2-对功能性协议的拦截`。

因此我们解决这个问题的方法是在marked-gfm-heading-id的配置中指定一个prefix，让标题所在标签id的第一个字符不是数字就可以了。现在它生成的id应该是`nctitle-2-对功能性协议的拦截`，世界和平……